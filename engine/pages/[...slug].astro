---
import Layout from "engine/layouts/Layout.astro"
import { getEntry } from "engine/contentful"

import Hero from "@/components/Hero/Hero.astro"
import * as components from "@/components"
import ContentModules from "engine/components/ContentModules.astro"

const { entry } = await getEntry(Astro.locals.engine.ref)

if (entry.type !== "Page") {
  return Astro.redirect("/")
}

const [hero] = entry.heroCollection.items || []
const contentModules = entry.modulesCollection.items || []
---

<Layout title={entry.metaTitle || entry.title}>
  <main>
    <div class="wrap">
      <h1>{entry.title}</h1>
      <time>{entry.sys.publishedAt}</time>
    </div>
    <!-- <TestCard data={{ title: "plop" }} /> -->
    {hero && <Hero data={hero} />}
    {contentModules && <ContentModules data={contentModules} />}
    <components.Foo data={{ title: "simple astro component test" }} />
    <components.Alert text="react component rendered on the server" />
    <components.Dummy data={{ title: "another simple astro component bringing its own styles" }} />
    <!-- <Button>Example</Button> -->
  </main>
</Layout>
